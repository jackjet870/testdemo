/*!
 * jQuery fixed header and column plugin.
 * Copyright(c) 2013 Archway Inc. All rights reserved.
 */
(function(n,t){"use strict";function tt(n){this.element=n;this.rowid=App.uuid();this.height=0;this.visible=!1}function h(){this.rows={};this.rowids=[]}function a(n){this.containerElement=n;this.initialize.call(this)}function it(n){if(i.query$(n,"tr").length>1)throw new Error("多段行での列の表示・非表示はサポートされません。");}function c(n,t,i){this.containerElement=n;this.options=i;this.srcElement=t;this.row={};this.initialize(this)}function e(n,t){this.containerElement=n;this.srcElement=t;this.initialize.call(this)}function o(n,i,r){this._globalLock=0;this.rows=[];this.containerElement=n;this.srcElement=i;this.options=t.extend({},o.DEFAULTS,r);this.pageHeight=0;this.renderHeight=0;this.templateHeight=0;this.scrollTop=0;this.offsetScrollbar=0;this.scrollHeight=0;this.isScrollDown=!1;this.events={render:{}};this.selectors={flowElement:undefined,$flowTable:i,$flowScroll:undefined,fixElement:undefined,$fixTable:undefined,$fixScroll:undefined};this.initialize.call(this)}function l(n){this.containerElement=n;this.initialize.call(this)}function v(n,t,i){this.containerElement=n;this.options=i;this.srcElement=t;this.row={};this.initialize.call(this)}function p(n,t,i){this.containerElement=n;this.srcElement=t;this.options=i;this.HeaderContainer=c;this.initialize(this)}function r(n,i,r){this.containerElement=n;this.srcElement=i;this.options=r;this.cache=h;this.lastTableOffset=0;this.initialize.call(this);var u=this;if(r.resize===!0){t(window).on("resize",function(){u.resize()});t(window).resize()}}function w(n,t,i){this.containerElement=n;this.srcElement=t;this.options=i;this.FooterContainer=v;this.initialize.call(this)}function u(n,i){this._globalLock=0;this.options={};this.element=t(n);this.originalElement=this.element.clone();this.cache=new h;this.pageTop=0;this.pageBottom=0;this.selectedRowElement=null;this.lastSelectedRowElement={};this.modules={HeaderView:p,BodyView:r,FooterView:w};this.selectors={thead:".dt-head",tbody:".dt-body",tfoot:".dt-foot",scrollContainer:".scroll-container",flowContainer:".flow-container",fixColumns:".fix-columns",container:".dt-container"};this.options=t.extend({},u.DEFAULTS,i);this.initialize.call(this,this.options)}var i,f,g;Function.prototype.bind||(Function.prototype.bind=function(n){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var r=Array.prototype.slice.call(arguments,1),u=this,t=function(){},i=function(){return u.apply(this instanceof t&&n?this:n,r.concat(Array.prototype.slice.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i});i={domElementFromjQuery:function(n){if(n instanceof jQuery){if(n.length===0)return null;n=n[0]}return n},query:function(n,t){return n=i.domElementFromjQuery(n),n.querySelectorAll(t)},query$:function(n,r){return(n=i.domElementFromjQuery(n),!n)?t():t(n.querySelectorAll(r))},single:function(n,t){return n=i.domElementFromjQuery(n),n.querySelector(t)},single$:function(n,r){return(n=i.domElementFromjQuery(n),!n)?t():t(n.querySelector(r))},cloneNode:function(n){if(n.length===0)return t();for(var r=[],i=0,u=n.length;i<u;i++)r.push(n[i].cloneNode(!0));return t(r)},getHeight:function(n){if(n.length===0)return 0;var t=n[0].clientHeight;return t?t:n[0].offsetHeight},adjustHeight:function(n,t,r){var o=i.getHeight(n),s=i.getHeight(t),u,f,e;return(typeof r=="undefined"||r===null)&&(r=1),u=o>=s?o:s,f=i.query$(t,"tr"),f.height(u/f.length+r),e=i.query$(n,"tr"),e.height(u/e.length+r),u},focusable:function(n){var r,u,f,e=n.nodeName.toLowerCase();return e==="area"?(r=n.parentNode,u=r.name,!n.href||!u||r.nodeName.toLowerCase()!=="map")?!1:(f=t("img[usemap=#"+u+"]")[0],!!f&&i.visible(f)):e==="span"?!1:(/input|select|textarea|button|object|a/.test(e)?!n.disabled:!1)&&i.visible(n)},visible:function(n){return t.expr.filters.visible(n)&&!t(n).parents().addBack().filter(function(){return t.css(this,"visibility")==="hidden"}).length}};t.expr[":"].focusable||t.extend(t.expr[":"],{focusable:function(n){return i.focusable(n)}});f={isLteIE8:function(){var t=window.navigator.userAgent.toLowerCase(),n=window.navigator.appVersion.toLowerCase();return t.indexOf("msie")!==-1&&(n.indexOf("msie 6.")!==-1||n.indexOf("msie 7.")!==-1||n.indexOf("msie 8.")!==-1)?!0:!1},scrollBar:{width:18,height:18}};h.prototype.id=function(n){return this.rows[n]};h.prototype.index=function(n){var t=this.rowids[n];return this.rows[t]};h.prototype.add=function(n){return this.rows[n.rowid]=n,this.rowids.push(n.rowid),n};h.prototype.remove=function(n){for(var t=0,i=this.rowids.length;t<i;t++)this.rowids[t]===n&&this.rowids.splice(t,1);delete this.rows[n]};var s={Acend:"glyphicon-sort-by-attributes",Descend:"glyphicon-sort-by-attributes-alt"},et=function(n,r){var f=n.target.tagName==="I"?t(n.target).closest("th"):t(n.target),h=f.attr("data-prop"),o={none:0,ascend:1,descend:2},l=f.closest(".dt-container"),u=i.query$(f,".glyphicon"),e,c;h&&h!==""&&(c=i.query$(l,"i.glyphicon").not(u),c.removeClass(s.Acend),c.removeClass(s.Descend),i.query$(f,"i."+s.Acend).length>0?(e=o.descend,u.removeClass(s.Acend),u.addClass(s.Descend)):i.query$(f,"i."+s.Descend).length>0?App.isFunc(r.options.onreset)?(r.options.onreset(),e=o.none):(e=o.ascend,u.removeClass(s.Descend),u.addClass(s.Acend)):(e=o.ascend,u.removeClass(s.Descend),t(u[0]).addClass(s.Acend)),r.modules.BodyView.sort(h,e),i.single$(r.modules.BodyView.flowElement,".dt-body").scrollTop(0))},b=function(n,r,u,f){var h=n.clone(),y,p,w,b,c,v,k,o,e=0,a=0,l=0,d=0,s,g,nt;return f=f+1,g=i.single$(h,"table").children(),nt=i.single$(n,"table").children(),g.each(function(n,u){for(c=i.query$(t(u),"tr"),y=i.query$(t(nt[n]),"tr"),s=new Array(c.length),e=0,a=c.length;e<a;e++)s[e]=0;var h=0,g=0;for(e=0,a=c.length;e<a;e++)for(k=c[e],w=y[e],v=i.query$(t(k),r),p=i.query$(t(w),r),l=0,d=v.length;l<d;l++){if(o=v[l],b=p[l],s[e]++,o.colSpan>1&&s[e]<=f&&s[e]+(o.colSpan-1)>f)throw new Error("列の固定で指定されたインデックスでは固定位置を揃えることができません。");if(s[e]+=o.colSpan>1?o.colSpan-1:0,s[e]<=f&&o.rowSpan>1)for(h=e+1,g=o.rowSpan+e;h<g;h++)s[h]++,s[h]+=o.colSpan>1?o.colSpan-1:0;s[e]>f?t(o).remove():t(b).remove()}}),h.css({overflow:"",overflowX:"",overflowY:"",width:""}),i.single$(h,"table").css("width","auto"),i.single$(h,"table").css("max-width",""),h.addClass(u)},d=function(n){var u=i.single$(n,".flow-container .dt-head"),r=i.single$(n,".fix-columns .dt-head");i.query$(u,".glyphicon").replaceWith(t("<i class='glyphicon'><\/i>"));r&&i.query$(r,".glyphicon").replaceWith(t("<i class='glyphicon'><\/i>"))};a.prototype.initialize=function(){var n=this;n.containerElement.length>1?(this.fixElement=n.containerElement[0],this.flowElement=n.containerElement[1]):this.flowElement=n.containerElement[0]};a.prototype.addCellClickEvent=function(n){this.flowElement.on("click","th",n);if(!App.isUndef(this.fixElement))this.fixElement.on("click","th",n)};a.prototype.showColumn=function(n){var r,e,c;typeof n=="string"&&(r=n);var u=this,o=u.flowElement.closest(".dt-container"),f=i.query$(o,".flow-container .dt-head thead"),s=t(u.fixElement).find(".dt-head th").length,l=t(u.flowElement).find(".dt-head th").length,h=function(t){if(r)return i.query$(t,"th[data-col='"+r+"'])");for(var e,f,u=0,o=t.length;u<o;u++)e=t[u],f=i.query(e,"th"),f[n]&&(f[n].style.display="")};it(f);n<=s-1&&l?(e=i.query$(o,".fix-columns .dt-head thead"),h(e),c=e.outerWidth(),f.closest("table").css("margin-left",c)):(n-=s,h(f))};a.prototype.hideColumn=function(n){var r,e,c;typeof n=="string"&&(r=n);var u=this,o=u.flowElement.closest(".dt-container"),f=i.query$(o,".flow-container .dt-head thead"),s=t(u.fixElement).find(".dt-head th").length,l=t(u.flowElement).find(".dt-head th").length,h=function(t){if(r)return i.query$(t,"th[data-col='"+r+"'])");for(var e,f,u=0,o=t.length;u<o;u++)e=t[u],f=i.query(e,"th"),f[n]&&(f[n].style.display="none")};it(f);n<=s-1&&l?(e=i.query$(o,".fix-columns .dt-head thead"),h(e),c=e.outerWidth(),f.closest("table").css("margin-left",c)):(n-=s,h(f))};c.prototype.initialize=function(){var n=this,r,u,c=i.single$(n.srcElement,"thead").clone(),o=n.srcElement,s,e,h;n.containerElement.length>1?(this.fixElement=n.containerElement[0],this.flowElement=n.containerElement[1]):this.flowElement=n.containerElement[0];s=i.query$(this.flowElement,"thead th,thead td");s.text("");o.css("margin-top","-2px");r=t("<div class='dt-head'><table><\/table><\/div>").prependTo(n.flowElement);this.row=new a(n.containerElement);i.single$(r,"table").prop("class",o.prop("class")).append(c);r.css("margin-right",f.scrollBar.width);n.options.fixedColumn===!0?(i.single$(r,"table").css("width",n.options.innerWidth),i.single$(r,"table").css("max-width",n.options.innerWidth),u=b(r,"th","dt-fix-head",n.options.fixedColumns),u.css("margin-right",""),this.fixElement.append(u),e=i.single$(u,"table").width(),i.single$(u,"table").css("width",e),i.single$(r,"table").css("margin-left",e-1),r.css("min-width",e+200-f.scrollBar.width),i.adjustHeight(r,u,1),n.options.responsive&&(f.isLteIE8()||(i.query$(r,"table").css("table-layout","fixed"),i.query$(u,"table").css("table-layout","fixed")))):n.options.responsive&&(h=function(n,i){for(var u,r=0,f=n.length;r<f;r++)u=n[r],t(u).css("width")||t(u).css("min-width",i)},h(i.query$(r,"th,td"),40),i.single$(this.flowElement,".dt-head table").css("table-layout","fixed"));n.options.sortable===!0&&(t.each(r,function(n){i.query$(r[n],"[data-prop]").css("cursor","pointer").append(t("<i class='glyphicon'><\/i>"))}),n.row.addCellClickEvent(function(t){var i=n.srcElement.data("aw.dataTable");n.showWait({});et(t,i);n.hideWait({})}))};c.prototype.addScrollEvent=function(n){this.flowElement.on("scroll",".dt-head",n)};c.prototype.detachScrollEvent=function(){this.flowElement.off("scroll")};c.prototype.showWait=function(n){this.flowElement.closest(".dt-container").append("<div class='wait'><\/div>");App.isFunc(n)&&n()};c.prototype.hideWait=function(n){i.query$(this.flowElement.closest(".dt-container"),".wait").remove();App.isFunc(n)&&n()};var rt=function(n,t,i){if(n.selectedRowElement&&(n.lastSelectedRowElement=n.selectedRowElement),n.selectedRowElement=t,n.options.onselect&&t)n.options.onselect(i||{},t)},ut=function(n,i){setTimeout(function(){var r=n.element.find(":focusable:first");r.length>0&&t(r[0]).focus();rt(i,n,{target:t(n.element[0]).closest("table")[0]})},0)},ft=function(n,r){r.options.onselecting();var u=t(n.target),f=u.closest("tbody"),e=f.attr("data-rowid"),o=r.modules.BodyView.cache.id(e);setTimeout(function(){var t=u.closest(".dt-body"),s=t[0],c=t.closest(".dt-container"),f=c[0],h=t.scrollTop(),e;f&&(t.hasClass("dt-fix-body")?i.single(f,".flow-container>.dt-body").scrollTop=h:(i.single(f,".flow-container>.dt-body").scrollTop=h,e=u.offset().left-i.single$(t,"table").offset().left,e<s.scrollLeft&&(s.scrollLeft=e-10)),rt(r,o,n))},0)},y=function(n,i){var r=[],u=[];return r=t(n.element[0]).find(":focusable").toArray(),i.options.fixedColumn&&(u=t(n.element[1]).find(":focusable").toArray(),r=u.concat(r)),r},k={Tab:9,ArrowDown:40,ArrowUp:38},ot=function(n,i){var e=t(n.target),b=e.closest("tbody"),h=b.attr("data-rowid"),d=i.modules.BodyView.cache.id(h),r=y(d,i),g=function(n,i){return t(i[0]).is(n)},nt=function(n,i){return t(i[i.length-1]).is(n)},u,f,o,c,s,l,a,v,p,w;if(r.length<=0)return!1;if(n.keyCode===k.Tab&&n.shiftKey===!1)if(n.preventDefault(),u=r.indexOf(e[0]),a=u+1,v=r[a],nt(e,r)){if(f=i.modules.BodyView.cache.rowids.indexOf(h),o=f+1,o===i.modules.BodyView.cache.rowids.length)return!1;c=i.modules.BodyView.cache.index(o);r=y(c,i);r.length>0&&r[0].focus()}else i.options.ontabing(),v.focus(),i.options.ontabed();else if(n.keyCode===k.Tab&&n.shiftKey===!0)if(n.preventDefault(),u=r.indexOf(e[0]),p=u-1,w=r[p],g(e,r)){if(f=i.modules.BodyView.cache.rowids.indexOf(h),s=f-1,s<0)return!1;l=i.modules.BodyView.cache.index(s);r=y(l,i);r.length>0&&(i.options.ontabing(),r[r.length-1].focus(),i.options.ontabed())}else i.options.ontabing(),w.focus(),i.options.ontabed();else if(n.keyCode===k.ArrowDown){if(f=i.modules.BodyView.cache.rowids.indexOf(h),u=r.indexOf(e[0]),o=f+1,o===i.modules.BodyView.cache.rowids.length)return!1;c=i.modules.BodyView.cache.index(o);r=y(c,i);r.length>0&&r[u].focus()}else if(n.keyCode===k.ArrowUp){if(f=i.modules.BodyView.cache.rowids.indexOf(h),u=r.indexOf(e[0]),s=f-1,s<0)return!1;l=i.modules.BodyView.cache.index(s);r=y(l,i);r.length>0&&(i.options.ontabing(),r[u].focus(),i.options.ontabed())}};e.prototype.initialize=function(){var n=this,i;n.containerElement.length>1?(n.fixElement=n.containerElement[0],n.flowElement=n.containerElement[1]):n.flowElement=n.containerElement[0];i=n.srcElement.data("aw.dataTable");n.addChangeEvent(function(n){var u=t(n.target),f=u.closest("tbody"),e=f.attr("data-rowid"),r=i.modules.BodyView.cache.id(e);if(i.options.onchange&&r)i.options.onchange(n,r)});n.addCellFocusEvent(function(n){ft(n,i)});n.addCellClickEvent(function(n){ft(n,i)});n.addKeyDownEvent(function(n){ot(n,i)})};e.prototype.addChangeEvent=function(n){this.containerElement.on("change","td",n)};e.prototype.detachChangeEvent=function(){this.containerElement.off("change")};e.prototype.addKeyDownEvent=function(n){this.containerElement.on("keydown","td",n)};e.prototype.addCellClickEvent=function(n){this.containerElement.on("click","td",n)};e.prototype.detachCellClickEvent=function(){this.containerElement.off("click")};e.prototype.addCellFocusEvent=function(n){this.containerElement.on("focus",":input",n)};e.prototype.detachCellFocusEvent=function(){this.containerElement.off("focus")};e.prototype.showColumn=function(n){var r=this,e=r.flowElement.closest("tbody"),o=i.query$(e,"tr"),s=r.fixElement.closest("tbody"),h=i.query$(s,"tr"),c=t(r.fixElement).find("td").length,u=t(r.flowElement).find("td").length,f=function(t){if(typeof n=="string")throw new Error("index must be a number");else for(var f,u,r=0,e=t.length;r<e;r++)f=t[r],u=i.query(f,"td"),u[n]&&(u[n].style.display="")};n<=c-1&&u?f(h):(n-=u,n<0&&(n*=-1),f(o))};e.prototype.hideColumn=function(n){var r=this,e=r.flowElement.closest("tbody"),o=i.query$(e,"tr"),s=r.fixElement===typeof undefined?r.fixElement.closest("tbody"):{},h=r.fixElement===typeof undefined?i.query$(s,"tr"):{},c=r.fixElement===typeof undefined?t(r.fixElement).find("td").length:0,u=t(r.flowElement).find("td").length,f=function(t){if(typeof n=="string")throw new Error("index must be a number");else for(var f,u,r=0,e=t.length;r<e;r++)f=t[r],u=i.query(f,"td"),u[n]&&(u[n].style.display="none")};n<=c-1&&u?f(h):(n-=u,n<0&&(n*=-1),f(o))};o.DEFAULTS={isScroll:!1};o.prototype.initialize=function(){var n=this,r,u,o,a,s,v,w,h,y,p,c,e,l;if(n.containerElement.length>1?(n.selectors.fixElement=n.containerElement[0],n.selectors.flowElement=n.containerElement[1]):n.selectors.flowElement=n.containerElement[0],h=n.selectors.flowElement.closest(".dt-container"),o=i.single$(n.selectors.flowElement,".dt-head"),r=n.selectors.$flowTable.wrap("<div class='dt-body'><\/div>").parent(),v=i.single$(n.selectors.flowElement,".dt-foot"),n.selectors.$flowScroll=n.selectors.$flowTable.wrap("<div class='dt-vscroll'><\/div>").parent(),f.scrollBar.width=r[0].offsetWidth-n.selectors.$flowScroll[0].offsetWidth,r.outerHeight(n.options.height),n.templateHeight=i.single$(h,"tbody.item-tmpl").outerHeight(),i.single$(h,"tbody.item-tmpl").hide(),i.single$(r,"table tfoot").hide(),a=i.query$(r,"thead th,thead td"),a.text(""),n.selectors.$flowTable.css({"table-layout":"fixed",position:"absolute",top:0}),n.options.fixedColumn===!0){i.single$(r,"table").css("width",n.options.innerWidth);i.single$(r,"table").css("max-width",n.options.innerWidth);r.css("overflow-x","scroll");u=b(r,"td","dt-fix-body",n.options.fixedColumns);b(r,"th","dt-fix-body",n.options.fixedColumns);s=i.single$(n.selectors.fixElement,".dt-head.dt-fix-head");w=i.single$(n.selectors.fixElement,".dt-foot.dt-fix-foot");i.query$(u,"table thead").remove();i.query$(u,"table tfoot").remove();y=i.query$(s,"thead").clone();i.query$(u,"table tbody.item-tmpl").before(y);u.height(r.height()+1-f.scrollBar.height);p=i.query$(u,"thead th, thead td");p.text("");i.query$(u,"table tr").css("height","0px");s.after(u);c=2;e=i.single$(s,"table").width();i.single$(u,"table").width(e-c);i.single$(r,"table").css("margin-left",e-c);r.css("min-width",e+200);n.selectors.$flowScroll.css("min-height","3px").css("width",n.options.innerWidth+e-1);n.selectors.$fixTable=i.single$(n.selectors.fixElement,".dt-fix-body table");n.selectors.$fixScroll=i.single$(n.selectors.fixElement,".dt-vscroll");n.addScrollEvent(function(i){var e=t(i.target),f=r.scrollTop();u.scrollTop(f);n._globalLock++||setTimeout(function(){f!==n.scrollTop?(n.isScrollDown=f>n.scrollTop,n.offsetScrollbar=f-n.scrollTop,n.scrollTop=f,n.options.isScroll=!0,n.events.render(n.options)):(o.scrollLeft(e.scrollLeft()),v.scrollLeft(e.scrollLeft()));setTimeout(function(){n._globalLock=0},0)},5);i.preventDefault();i.stopImmediatePropagation()});u.on("mousewheel",function(n){var u=t(this),f=n.originalEvent.wheelDelta,i=u.scrollTop()-f;return r.scrollTop(i),i>0?!1:void 0});n.options.responsive&&(f.isLteIE8()||(i.query$(u,"table").css("table-layout","fixed"),i.query$(r,"table").css("table-layout","fixed")))}else n.options.responsive&&(l=function(n,t){for(var r,i=0,u=n.length;i<u;i++)r=n[i],r.style.width||(r.style.minWidth=t)},l(i.query$(o,"th,td"),40),l(i.query$(n.selectors.$flowTable,"th,td"),40),n.selectors.$flowTable.css({"table-layout":"fixed",position:"absolute",top:0}),n.addScrollEvent(function(i){n._globalLock++||setTimeout(function(){var f=t(i.target),u=r.scrollTop();o.scrollLeft(f.scrollLeft());n.isScrollDown=u>n.scrollTop;n.offsetScrollbar=u-n.scrollTop;n.scrollTop=u;n.events.render({isScroll:!0});setTimeout(function(){n._globalLock=0},0)},1);i.preventDefault();i.stopImmediatePropagation()}))};o.prototype.insertRow=function(n,r,u){var f=this,h=f.selectors.$flowTable,v=f.selectors.$fixTable,c=f.rows,s=new e(r.element,h),o,l,a=r.height;return r.visible||r.element.hide(),o=s.containerElement[0],f.options.fixedColumn?(l=s.containerElement[1],u&&f.rows.length>0?(h[0].insertBefore(o,f.rows[0].containerElement[0]),v[0].insertBefore(l,f.rows[0].containerElement[1]),c.unshift(s)):(h[0].appendChild(o),v[0].appendChild(l),c.push(s)),r.height===0&&(a=i.adjustHeight(t(o),t(l),0))):(u&&f.rows.length>0?(h[0].insertBefore(o,f.rows[0].containerElement[0]),c.unshift(s)):(h[0].appendChild(o),c.push(s)),a=r.height===0?o.clientHeight:r.height),a};o.prototype.removeRow=function(n){var r=this,i=r.rows[n],e=r.srcElement.data("aw.dataTable"),o=t(i.containerElement[0]).attr("data-rowid"),f=e.modules.BodyView.cache.id(o),u=0;return i.detachCellFocusEvent(),i.detachCellClickEvent(),i.detachChangeEvent(),u=f.height>0?f.height:i.containerElement[0].clientHeight,r.renderHeight-=u,t(i.containerElement).remove(),r.rows.splice(n,1),u};o.prototype.getRowIndex=function(n){for(var u=this,i=u.selectors.$flowTable[0].tBodies,r,t=0;t<i.length;t++)if(r=i[t],r.getAttribute("data-rowid")===n){t--;break}return t};o.prototype.clear=function(){var n=this;n.pageHeight=0;n.renderHeight=0;n.scrollTop=0;n.scrollHeight=0;n.selectors.$flowTable.css("height","");n.selectors.$flowTable.css("top",n.scrollTop);n.selectors.$flowScroll.parent().scrollTop(n.scrollTop);n.options.fixedColumn&&(n.selectors.$fixTable.css({top:n.scrollTop}),n.selectors.$fixScroll.css("height",""),n.selectors.$fixScroll.parent().scrollTop(n.scrollTop))};o.prototype.cloneTemplateItem=function(){var n=this,t,r;return t=i.cloneNode(i.single$(n.selectors.flowElement,".item-tmpl")),n.options.fixedColumn&&(r=i.cloneNode(i.single$(n.selectors.fixElement,".dt-fix-body table tbody.item-tmpl"))),[r,t]};o.prototype.addScrollEvent=function(n){var t=i.single$(this.selectors.flowElement,".dt-body");t.on("scroll",n)};o.prototype.detachScrollEvent=function(){this.selectors.flowElement.off("scroll")};l.prototype.initialize=function(){var n=this;n.containerElement.length>1?(this.fixElement=n.containerElement[0],this.flowElement=n.containerElement[1]):this.flowElement=n.containerElement[0]};l.prototype.addCellClickEvent=function(n){this.containerElement.on("click","td",n)};l.prototype.detachCellClickEvent=function(){this.containerElement.off("click")};g=function(n){if(i.query$(n,"tr").length>1)throw new Error("多段行での列の表示・非表示はサポートされません。");};l.prototype.showColumn=function(n){var r,e,c;typeof n=="string"&&(r=n);var u=this,o=t(u.flowElement).closest(".dt-container"),f=i.query$(o,".flow-container .dt-foot tfoot"),s=t(u.fixElement).find(".dt-foot td").length,l=t(u.flowElement).find(".dt-foot td").length,h=function(t){if(r)return i.query$(t,"td[data-col='"+r+"'])");for(var e,f,u=0,o=t.length;u<o;u++)e=t[u],f=i.query$(e,"td"),f[n]&&(f[n].style.display="")};g(f);n<=s-1&&l?(e=i.query$(o,".fix-columns .dt-foot tfoot"),h(e),c=e.outerWidth(),f.closest("table").css("margin-left",c)):(n-=s,h(f))};l.prototype.hideColumn=function(n){var r,e,c;typeof n=="string"&&(r=n);var u=this,o=t(u.flowElement).closest(".dt-container"),f=i.query$(o,".flow-container .dt-foot tfoot"),s=t(u.fixElement).find(".dt-foot td").length,l=t(u.flowElement).find(".dt-foot td").length,h=function(t){if(r)return i.query$(t,"td[data-col='"+r+"'])");for(var e,f,u=0,o=t.length;u<o;u++)e=t[u],f=i.query$(e,"td"),f[n]&&(f[n].style.display="none")};g(f);n<=s-1&&l?(e=i.query$(o,".fix-columns .dt-foot tfoot"),h(e),c=e.outerWidth(),f.closest("table").css("margin-left",c)):(n-=s,h(f))};v.prototype.initialize=function(){var n=this,r,u,s=i.single$(n.srcElement,"tfoot").clone(),c=n.srcElement,o,e,h;i.single$(n.srcElement,"tfoot").remove();n.containerElement.length>1?(this.fixElement=n.containerElement[0],this.flowElement=n.containerElement[1]):this.flowElement=n.containerElement[0];s.show();o=i.query$(this.flowElement,"tfoot th,tfoot td");o.css({height:"0px",padding:"0px",borderTop:0,borderBottom:0});o.text("");r=t("<div class='dt-foot' style='overflow:hidden'><table><\/table><\/div>").appendTo(n.flowElement);this.row=new l(n.containerElement);i.single$(r,"table").prop("class",c.prop("class")).append(s);r.css("margin-right",f.scrollBar.width);n.options.fixedColumn===!0?(i.single$(r,"table").css("width",n.options.innerWidth),i.single$(r,"table").css("max-width",n.options.innerWidth),u=b(r,"td","dt-fix-foot",n.options.fixedColumns),u.css("margin-right",""),u.css("margin-top",f.scrollBar.height-1),this.fixElement.append(u),e=i.single$(u,"table").width(),i.single$(u,"table").css("width",e),i.single$(r,"table").css("margin-left",e-1),r.css("min-width",e+200-f.scrollBar.width),i.adjustHeight(r,u,1),n.options.responsive&&(f.isLteIE8()||(i.query$(r,"table").css("table-layout","fixed"),i.query$(u,"table").css("table-layout","fixed")))):n.options.responsive&&(h=function(n,i){for(var u,r=0,f=n.length;r<f;r++)u=n[r],t(u).css("width")||t(u).css("min-width",i)},h(i.query$(r,"th,td"),40),i.single$(this.flowElement,".dt-head table").css("table-layout","fixed"))};v.prototype.addScrollEvent=function(n){this.flowElement.on("scroll",".dt-foot",n)};v.prototype.detachScrollEvent=function(){this.flowElement.off("scroll")};p.prototype.initialize=function(){var n=this;n.HeaderContainer=new c(n.containerElement,n.srcElement,n.options)};r.prototype.initialize=function(){var n=this;n.containerElement.length>1?(this.fixElement=n.containerElement[0],this.flowElement=n.containerElement[1]):this.flowElement=n.containerElement[0];n.cache=new h;n.BodyContainer=new o(n.containerElement,n.srcElement,n.options);n.BodyContainer.events.render=n.render.bind(n)};r.prototype.clearAllRender=function(){for(var n=this,r=n.BodyContainer.rows.length,i=0;i<r;i++)t(n.BodyContainer.rows[i].containerElement).remove();n.BodyContainer.rows=[];n.BodyContainer.renderHeight=0};var st=function(n){var t=n.BodyContainer,r,i,u,f=t.isScrollDown?n.options.height:0,e=0;if(t.scrollTop>0)for(i=0,u=n.cache.rowids.length;i<u;i++){if(r=n.cache.id(n.cache.rowids[i]),f+=r.height===0?t.templateHeight:r.height,f>=t.scrollTop)break;e++}return e},ht=function(n){var t=n.BodyContainer,i=0,r=0,u=0;for(u=t.isScrollDown?0:t.rows.length-1,t.scrollHeight+=t.isScrollDown?t.offsetScrollbar:t.offsetScrollbar*-1;t.scrollHeight>=n.options.height;)if(r=t.removeRow(u),t.scrollHeight-=r,i+=r,t.rows.length>0)u=t.isScrollDown?0:t.rows.length-1;else return i;return i},nt=function(n){n.selectors.$flowScroll.height(n.pageHeight);n.selectors.$fixScroll&&n.selectors.$fixScroll.height(n.pageHeight)},ct=function(n,t,i){for(var r=n.BodyContainer,u,o=n.options.height*2,e=0,f;r.renderHeight<=o+i;){if(r.isScrollDown){if(t++,t>=n.cache.rowids.length)break}else if(t--,t<0)break;u=n.cache.index(t);f=r.insertRow(t,u,!r.isScrollDown);u.height===0&&(r.pageHeight+=f-r.templateHeight,nt(r),u.height=f,n.cache.rows[u.rowid]=u);r.renderHeight+=u.height;e-=u.height}return e},lt=function(n){var i=n.BodyContainer,r=0,t,u=n.options.height*2;for(n.clearAllRender();i.renderHeight<=u;)if(t=n.cache.index(r),t.height=i.insertRow(r,t),i.renderHeight+=t.height,n.cache.rows[t.rowid]=t,r++,r===n.cache.rowids.length)break;n.lastTableOffset=0;i.selectors.$flowTable.css("top",n.lastTableOffset);n.options.fixedColumn&&i.selectors.$fixTable.css({top:n.lastTableOffset})},at=function(n){var t=n.BodyContainer,i=st(n),r,u=n.options.height*2;for(n.clearAllRender();t.renderHeight<=u;)if(r=n.cache.index(i),r.height=t.insertRow(i,r,t.isScrollDown),t.renderHeight+=r.height,n.cache.rows[r.rowid]=r,t.isScrollDown){if(i--,i<0)break}else if(i++,i===n.cache.rowids.length)break;return t.scrollHeight=Math.ceil(t.renderHeight/2),t.scrollTop===0?0:t.scrollTop-Math.ceil(t.renderHeight/2)};r.prototype.render=function(n){var r=this,c=r.srcElement.data("aw.dataTable"),i=r.BodyContainer,o,s,f={current:0,last:r.lastTableOffset,sumary:function(){return this.current+this.last}},u,e;if(n.isScroll)if(i.options.isScroll=!1,s=i.isScrollDown?i.offsetScrollbar:i.offsetScrollbar*-1,s>i.renderHeight)f.last=at(r);else{o=i.isScrollDown?i.rows[i.rows.length-1]:i.rows[0];var h=ht(r),l=r.cache.rowids.indexOf(t(o.containerElement[0]).attr("data-rowid")),a=ct(r,l,h);f.current=i.isScrollDown?h:a;f.last=i.scrollTop===0?0:f.last}else u=r.cache.id(n.rowid),e=0,u.visible=!0,e=i.insertRow(i.rows.length,u,!1),u.height===0&&(u.height=e,i.pageHeight+=e-i.templateHeight),r.cache.rows[u.rowid]=u,i.renderHeight+=u.height,n.isFocus===!0&&ut(u,c);r.lastTableOffset=f.sumary();i.selectors.$flowTable.css("top",r.lastTableOffset);r.options.fixedColumn&&i.selectors.$fixTable.css({top:r.lastTableOffset})};r.prototype.renderRows=function(n){for(var t=this,e=t.srcElement.data("aw.dataTable"),i=t.BodyContainer,r,u=0,f=t.cache.rowids.length;u<f;u++)r=t.cache.id(t.cache.rowids[u]),r.visible=!0,i.renderHeight<=t.options.height*2?(r.height=i.insertRow(i.rows.length,r),i.renderHeight+=r.height,i.pageHeight+=r.height):i.pageHeight+=i.templateHeight,t.cache.rows[r.rowid]=r;n.isFocus===!0&&ut(t.cache.index(0),e);nt(i)};r.prototype.addRow=function(n,t){var u=this,f=u.BodyContainer.cloneTemplateItem(),e=f[0],i=f[1],o=u.srcElement.closest(".dt-container"),r;d(o);n&&(i=n(i.add(e)));i.removeClass("item-tmpl");i.addClass("new");i.show();r=new tt(i);u.cache.add(r);i.attr("data-rowid",r.rowid);this.render({rowid:r.rowid,isFocus:t})};r.prototype.addRows=function(n,t,i){var s=this,h=s.BodyContainer,a=h.selectors.$flowTable.closest(".dt-container"),r,c,f,u,e,l,o;for(d(a),u=0,e=n.length;u<e;u++)o=h.cloneTemplateItem(),c=o[0],r=o[1],l=n[u],r.__index=u,t&&(r=t(r.add(c),l)),r.removeClass("item-tmpl"),r.addClass("new"),r.show(),f=new tt(r),s.cache.add(f),r.attr("data-rowid",f.rowid),u===e-1&&this.renderRows({isFocus:i})};r.prototype.getRow=function(n){var i=this,r=t(n),u=r.closest("tbody"),f=u.attr("data-rowid");return i.cache.id(f)};r.prototype.enableRowCount=function(){var n=this;return n.cache.rowids.length};r.prototype.selectRow=function(n){var i=this,r=t(n),u=r.closest("tbody");i.flowElement.find(".select-tab").removeClass("selected");u.find(".select-tab").addClass("selected")};r.prototype.updateRow=function(n,i){var r=this,u=t(i),f=u.closest("tbody"),e=f.attr("data-rowid");Object.keys(n).forEach(function(t){r.cache.id(e)[t]=n[t]})};r.prototype.deleteRow=function(n,i){var u=this,r=u.BodyContainer,h=t(n),c=h.closest("tbody"),f,e,o;if(f=c.attr("data-rowid"),e=u.cache.id(f),App.isFunc(i)&&i(e.element),o=r.getRowIndex(f),r.pageHeight-=r.removeRow(o),nt(r),u.cache.remove(f),!(r.rows.length<=0)){var l=r.rows[r.rows.length-1],a=u.cache.rowids.indexOf(t(l.containerElement[0]).attr("data-rowid")),v=a+1,s=u.cache.index(v);s&&u.render({isScroll:!1,isFocus:!1,rowid:s.rowid})}};r.prototype.clear=function(){var n=this,u=n.srcElement.closest(".dt-container"),r=n.BodyContainer,i,f=r.rows.length;for(d(u),i=0;i<f;i++)t(r.rows[i].containerElement).remove();n.cache=new h;n.BodyContainer.rows=[];n.BodyContainer.clear()};r.prototype.showColumn=function(n){var i=this.BodyContainer.rows;t.each(i,function(t){i[t].showColumn(n)})};r.prototype.hideColumn=function(n){var i=this.BodyContainer.rows;this.BodyContainer.flowElement.find(".dt-body thead tr th")[n-1].style.display="none";t.each(i,function(t){i[t].hideColumn(n)})};r.prototype.sort=function(n,i){var o={none:0,ascend:1,descend:2},r=this,u=function(n,i){var u,f,e;if(!App.isUndefOrNull(i))return(u=n.element[0].querySelector("[data-prop='"+i+"']"),!u&&n.element.length>1&&(u=n.element[1].querySelector("[data-prop='"+i+"']")),f=u.value||u.innerText,e=u.getAttribute("data-format"),r.options.parse&&r.options.parse.converteByFormatDataAnnotation&&e&&(f=r.options.parse.converteByFormatDataAnnotation(e,t(u),f)),f&&f!=="")?f:u.innerText},f=function(n,t){return Object.prototype.toString.call(n)==="[object Number]"&&Object.prototype.toString.call(t)==="[object Number]"},e=function(n,t){return Object.prototype.toString.call(n)==="[object Date]"&&Object.prototype.toString.call(t)==="[object Date]"},s=function(t,r){var s={};return s.a=u(t,n),s.b=u(r,n),i===o.ascend?f(s.a,s.b)?s.a-s.b:e(s.a,s.b)?s.a.getTime()-s.b.getTime():s.a<s.b?-1:1:f(s.a,s.b)?s.b-s.a:e(s.a,s.b)?s.b.getTime()-s.a.getTime():s.a>s.b?-1:1};r.cache.rowids.sort(function(n,t){return r.BodyContainer.clear(),s(r.cache.id(n),r.cache.id(t))});r.BodyContainer.clear();r.cache.rowids.length>0&&lt(r)};r.prototype.resize=function(){var n=this,f=n.flowElement.closest(".dt-container"),r=i.single$(n.flowElement,".dt-body"),u=i.single$(n.fixElement,".dt-body");r.css("overflow-y")==="scroll"&&(n._globalLock++||setTimeout(function(){var o=r.offset().top,s=t(window).height(),h=i.query$(f,".dt-foot").height(),e=s-o-h-(n.options.resizeOffset+n.options.addedOffset);e<n.options.height?(r.height(e),n.options.fixedColumn===!0&&u.height(e-17),r.closest(".part").css("margin-bottom","0px")):(r.height(n.options.height),n.options.fixedColumn===!0&&u.height(n.options.height-17),r.closest(".part").css("margin-bottom","32px"));setTimeout(function(){n._globalLock=0},0)},5))};r.prototype.each=function(n){var i,t,r=0,u=this;for(i in u.cache.rows)if((++r,t=u.cache.rows[i],!t.element.is(".item-tmpl"))&&n(t,r))break};r.prototype.filter=function(n){var i=this,r,u=0,t;for(r in i.cache.rows)if((++u,t=i.cache.rows[r],!t.element.is(".item-tmpl"))&&n(t,u))break};r.prototype.setFocus=function(n){var u=this,c=u.BodyContainer,e=t(n).closest("tbody"),o=e.attr("data-rowid"),s=u.cache.id(o),l=t(n).attr("data-prop"),f,i,h,r;if(e.length===0||!s)return!1;for(f=0,r=t.map(u.cache.rows,function(n){return[n]}),i=0,h=r.length;i<h;i++){if(r[i].rowid===o)break;f+=r[i].height}return c.selectors.$divBody.scrollTop(f),setTimeout(function(){s.element.findP(l).focus()},0),!0};w.prototype.initialize=function(){var n=this;n.FooterContainer=new v(n.containerElement,n.srcElement,n.options)};u.DEFAULTS={height:"100%",innerWidth:2e3,fixedColumn:!1,fixedColumns:0,sortable:!1,footer:!1,resize:!1,resizeOffset:110,addedOffset:0,responsive:!0,onchange:function(){},onsorting:function(){},onsorted:function(){},onselecting:function(){},onselected:function(){},ontabing:function(){},ontabed:function(){},modules:{HeaderView:p,BodyView:r,FooterView:w}};u.prototype.initialize=function(n){var u=this,i=u.element,s=i.wrap("<div class='dt-container'><\/div>").parent(),o=i.wrap("<div class='flow-container'><\/div>").parent(),e,f=[o];n.fixedColumn===!0&&(e=t("<div class='fix-columns'><\/div>"),e.insertBefore(o),f.unshift(e));u.modules.HeaderView=new p(f,i,n);u.modules.FooterView=new w(f,i,n);u.modules.BodyView=new r(f,i,n)};u.prototype.filter=function(n){this.data("aw.dataTable").modules.BodyView.filter(n)};u.prototype.enableRowCount=function(n){this.data("aw.dataTable").modules.BodyView.enableRowCount(n)};u.prototype.addRow=function(n,t){this.data("aw.dataTable").modules.BodyView.addRow(n,t)};u.prototype.addRows=function(n,t,i){this.data("aw.dataTable").modules.BodyView.addRows(n,t,i)};u.prototype.getRow=function(n,t){t(this.data("aw.dataTable").modules.BodyView.getRow(n))};u.prototype.clear=function(){this.data("aw.dataTable").modules.BodyView.clear();this.selectedRowElement=undefined;this.lastSelectedRowElement=undefined};u.prototype.showColumn=function(n){this.data("aw.dataTable").modules.BodyView.showColumn(n);this.data("aw.dataTable").modules.HeaderView.HeaderContainer.row.showColumn(n)};u.prototype.deleteRow=function(n,t){this.data("aw.dataTable").modules.BodyView.deleteRow(n,t);this.lastSelectedRowElement=undefined};u.prototype.each=function(n){this.data("aw.dataTable").modules.BodyView.each(n)};u.prototype.selectedRow=function(n){n(this.data("aw.dataTable").selectedRowElement)};u.prototype.lastSelectedRow=function(n){n(this.data("aw.dataTable").lastSelectedRowElement)};u.prototype.showWait=function(){this.data("aw.dataTable").modules.HeaderView.HeaderContainer.showWait()};u.prototype.hideWait=function(){this.data("aw.dataTable").modules.HeaderView.HeaderContainer.hideWait()};u.prototype.setFocus=function(n){this.data("aw.dataTable").modules.BodyView.setFocus(n)};t.fn.dataTable=function(n){var i=arguments;return this.each(function(){var r=t(this),f=r.data("aw.dataTable");f||r.data("aw.dataTable",f=new u(r,n));typeof n=="string"&&f[n].apply(r,Array.prototype.slice.call(i,1).concat(f))})};t.fn.dataTable.Constructor=u;n.DOMUtil=i;n.BrowserSupport=f;n.HeaderView=p;n.HeaderContainer=c;n.HeaderRow=a;n.BodyView=r;n.BodyContainer=o;n.BodyRow=e;n.FooterView=w;n.FooterContainer=v;n.FooterRow=l})(this,jQuery);
//# sourceMappingURL=datatable.min.js.map
